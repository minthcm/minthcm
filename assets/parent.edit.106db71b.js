import{l as H,Z as I,bl as j,z as v,e as B,n as u,q as V,j as i,s as p,bj as D,B as G,C as r,A as K,k as z,bm as J,w as _,x as M,bn as Z,bo as b,J as Q,y as L,t as W,F as X,v as Y,r as q,bp as ee,P as ae,aa as te,bq as ne,br as le,bs as O,_ as se}from"./index.66753496.js";const oe={class:"parent-container"},ie={key:2},de=["innerHTML"],ue=500,re=H({__name:"parent.edit",props:{defs:{},label:{},modelValue:{},data:{}},emits:["update:modelValue"],setup(S,{emit:A}){const a=S,C=A;let g=null;const d=I(),R=j(),f=v(!1),m=v(a.data.bean[a.defs.id_name]?[{id:a.data.bean[a.defs.id_name],name:a.modelValue}]:[]),T=v({id:a.data.bean[a.defs.id_name],name:a.data.bean[a.defs.name]}),o=B({get(){return T.value},set(t){a.data.bean[a.defs.id_name]=t.id,T.value=t,C("update:modelValue",[a.defs.id_name])}}),w=v(""),k=B({get(){var t,e,l,n;return d.translateListValue((l=(e=a.data.bean.parent_type)!=null?e:(t=a.defs)==null?void 0:t.default)!=null?l:"",(n=a.defs)==null?void 0:n.options)},set(t){var n;let e=d.languages.app_list_strings[(n=a.defs)==null?void 0:n.options],l=Object.keys(e).find(s=>e[s]===t);a.data.bean[a.defs.type_name]=l,w.value=l,o.value={id:"",name:""},C("update:modelValue",[a.defs.type_name])}}),c=v(!1);async function x(t){var e,l,n;if(o.value.name.length>=3){m.value=[],c.value=!0,f.value=!0;const s=(n=(l=(e=t==null?void 0:t.target)==null?void 0:e.value)!=null?l:a.data.bean[a.defs.name])!=null?n:"";g&&clearTimeout(g),g=window.setTimeout(async()=>{var E,N;const y=await ne.getListData(a.data.bean.parent_type,"",{must:[{wildcard:{name:s+"*"}}]});(N=(E=y.data)==null?void 0:E.results)!=null&&N.length&&(m.value=y.data.results.sort((U,F)=>U.name.localeCompare(F.name,"pl"))),c.value=!1},ue)}else m.value=[]}function P(){R.showPopup({component:le,title:I().translateListValue(a.data.bean.parent_type,"moduleList"),icon:"mdi-view-list",data:{moduleName:a.data.bean.parent_type,popupMode:"single",fieldToNameArray:{id:a.defs.id_name,name:a.defs.name},onConfirm:t=>{o.value={id:t.nameToValueArray[a.defs.id_name],name:t.nameToValueArray[a.defs.name]}},onClose:()=>{}}})}function $(t){o.value={id:t.id,name:t.name}}function h(t,e){if(e=O.encode(e),t=O.encode(t),!e)return t;try{const l=new RegExp(`\\b(${e.split(" ").filter(n=>!["AND","OR"].includes(n)&&n.length>2).join("|")})`,"gi");return t=t.replace(l,'<span class="highlighted">$&</span>'),t}catch{return t}}return(t,e)=>{var l;return u(),V("div",oe,[i(G,{items:p(d).getList((l=a.defs)==null?void 0:l.options),label:p(d).label("LBL_ASSIGNED_TO_MODULE"),variant:"outlined",density:"compact","hide-details":"",modelValue:k.value,"onUpdate:modelValue":e[0]||(e[0]=n=>k.value=n),"item-value":"value","item-title":"key",onKeyup:[e[1]||(e[1]=D(n=>t.$emit("inlineEditSave"),["enter"])),e[2]||(e[2]=D(n=>t.$emit("inlineEditCancel"),["esc"]))]},null,8,["items","label","modelValue"]),i(te,{modelValue:f.value,"onUpdate:modelValue":e[7]||(e[7]=n=>f.value=n),location:"bottom"},{activator:r(n=>[i(K,z({label:p(d).label("LBL_ASSIGNED_TO_RECORD"),variant:"outlined",density:"compact","hide-details":"",modelValue:o.value.name,"onUpdate:modelValue":e[4]||(e[4]=s=>o.value.name=s)},n.props,{onInput:e[5]||(e[5]=s=>x(s)),onClick:e[6]||(e[6]=s=>f.value=!1)}),{"append-inner":r(()=>[i(J,{class:"search-prepend-icon"},{default:r(()=>[o.value.name?(u(),_(M,{key:0,icon:"mdi-close",onClick:e[3]||(e[3]=s=>o.value={id:"",name:""})})):(u(),_(M,{key:1,icon:"mdi-magnify"}))]),_:1})]),_:2},1040,["label","modelValue"])]),default:r(()=>[i(Z,null,{default:r(()=>[c.value?(u(),_(b,{key:0},{default:r(()=>[i(Q,{color:"primary",indeterminate:""})]),_:1})):L("",!0),!c.value&&!m.value.length?(u(),_(b,{key:1,class:"text-caption",textContent:W(!m.value||o.value.name.length<3?p(d).label("LBL_MINT4_GS_HELP_TIP"):p(d).label("LBL_MINT4_GS_NO_RECORDS_FOUND"))},null,8,["textContent"])):L("",!0),c.value?L("",!0):(u(),V("div",ie,[(u(!0),V(X,null,Y(m.value,(n,s)=>(u(),_(b,{onClick:y=>$(n),key:s},{default:r(()=>[q("span",{innerHTML:h(n.name,o.value.name)},null,8,de)]),_:2},1032,["onClick"]))),128))])),i(ee),i(b,null,{default:r(()=>[i(ae,{variant:"text",text:p(d).label("LBL_ADVANCED_SEARCH_BUTTON"),onClick:P,icon:"mdi-text-search",color:"primary"},null,8,["text"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}});const pe=se(re,[["__scopeId","data-v-5b3bed94"]]);export{pe as default};
