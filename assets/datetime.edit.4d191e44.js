import{a1 as U,$ as C,l as L,z as p,aX as $,e as n,a7 as l,H as Q,a8 as z,n as P,q as x,j as s,C as m,ab as k,x as M,k as S,N as T,A as b,bb as D,_ as B}from"./index.10d9344d.js";import{V as E}from"./VDatePicker.08861d44.js";import"./VSpacer.54d702f0.js";class N{static getDateTimeFormat(){const r=U(),u=C(),f=r.user.preferences.date_time_preferences.date||u.initData.global.date_format||"Y-m-d",d=r.user.preferences.date_time_preferences.time||u.initData.global.time_format||"H:i";return{date:f,time:d}}static getTimeFormatGeneralized(){switch(this.getDateTimeFormat().time){case"H:i":case"H.i":return"24hr";default:return"ampm"}}}const A=L({__name:"datetime.edit",props:{defs:{},label:{},modelValue:{},data:{}},emits:["update:modelValue"],setup(y,{emit:r}){const u=y,f=r,d=p(!1),c=p(!1),a=p(u.modelValue),V=$(),_=n(()=>N.getTimeFormatGeneralized()),v=n({get(){var t;const e=l.fromSQL(a.value);return e.isValid&&e.toFormat(((t=V.user)==null?void 0:t.date_format)||"yyyy-MM-dd")||""},async set(e){var i;d.value=!1,e!=null&&e.trim()||(a.value="");const t=l.fromFormat(e,((i=V.user)==null?void 0:i.date_format)||"yyyy-MM-dd");t.isValid&&(a.value=t.toSQLDate())}}),F=n({get(){const e=l.fromSQL(a.value,{zone:"UTC"});return e.isValid&&e.toLocal().toFormat("HH:mm")||"00:00"},set(e){c.value=!1,e=l.fromSQL(e).setZone("UTC").toFormat("HH:mm");const t=l.fromSQL(a.value,{zone:"UTC"});t.isValid?a.value=`${t.toFormat("yyyy-MM-dd")} ${e}:00`:a.value=""}}),H=n({get(){var e;return(e=a.value)!=null&&e.trim()?new Date(a.value):new Date},set(e){const t=l.fromJSDate(e);if(t.isValid){const i=l.fromSQL(a.value);i.isValid?a.value=`${t.toFormat("yyyy-MM-dd")} ${i.toFormat("HH:mm:ss")}`:a.value=t.toFormat("yyyy-MM-dd HH:mm:ss")}}}),g=n({get(){const e=l.fromSQL(a.value,{zone:"UTC"});return e.isValid&&e.toLocal().toFormat("HH:mm")||"00:00"},set(e){e=l.fromFormat(e,"HH:mm").setZone("UTC").toFormat("HH:mm");const t=l.fromSQL(a.value,{zone:"UTC"});t.isValid?a.value=`${t.toFormat("yyyy-MM-dd")} ${e}:00`:a.value=""}});return Q(a,e=>{d.value=!1,c.value=!1,l.fromSQL(e==null?void 0:e.toString()).isValid?(console.log("new val",a.value),f("update:modelValue",a.value)):(console.log("new val empty"),f("update:modelValue",""))}),(e,t)=>{const i=z("v-time-picker");return P(),x("div",{class:"mint-date-field-detail",onKeyup:[t[6]||(t[6]=D(o=>e.$emit("inlineEditSave"),["enter"])),t[7]||(t[7]=D(o=>e.$emit("inlineEditCancel"),["esc"]))]},[s(b,{label:e.label,variant:"outlined",density:"compact","hide-details":"",modelValue:v.value,"onUpdate:modelValue":t[2]||(t[2]=o=>v.value=o)},{"append-inner":m(()=>[s(k,{modelValue:d.value,"onUpdate:modelValue":t[1]||(t[1]=o=>d.value=o),offset:"16","close-on-content-click":!1},{activator:m(({props:o})=>[s(M,S({class:"mint-date-field-btn"},o),{default:m(()=>[T("mdi-calendar")]),_:2},1040)]),default:m(()=>[s(E,{modelValue:H.value,"onUpdate:modelValue":t[0]||(t[0]=o=>H.value=o),"hide-actions":""},{header:m(()=>[]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])]),_:1},8,["label","modelValue"]),s(b,{disabled:!v.value,variant:"outlined",density:"compact","hide-details":"",modelValue:F.value,"onUpdate:modelValue":t[5]||(t[5]=o=>F.value=o)},{"append-inner":m(()=>[s(k,{modelValue:c.value,"onUpdate:modelValue":t[4]||(t[4]=o=>c.value=o),offset:"16","close-on-content-click":!1},{activator:m(({props:o})=>[s(M,S({class:"mint-date-field-btn"},o),{default:m(()=>[T("mdi-clock-time-eight-outline")]),_:2},1040)]),default:m(()=>[s(i,{modelValue:g.value,"onUpdate:modelValue":t[3]||(t[3]=o=>g.value=o),format:_.value,"ampm-in-title":_.value==="ampm"},{header:m(()=>[]),_:1},8,["modelValue","format","ampm-in-title"])]),_:1},8,["modelValue"])]),_:1},8,["disabled","modelValue"])],32)}}});const Z=B(A,[["__scopeId","data-v-746e3376"]]);export{Z as default};
